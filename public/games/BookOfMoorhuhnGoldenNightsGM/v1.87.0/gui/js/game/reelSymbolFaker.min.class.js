/**
 * class providing the symbols for the fake reels
 * @copyright LoCoNET GmbH 2018-07-16
 * @author Robin Scholz <scholz@loconet.info>
 */function ReelSymbolFaker(e){function y(){if(!r)return;var e={};for(var t in r)e[t]=~~(r[t].length*Math.random());return e}function b(e,n){var i={},s=r[e];for(var u=0;u<n;u++)++o[e],o[e]>=s.length&&(o[e]=0),symbolID=s[o[e]],v&&v[e]&&(symbolID=v[e]),symbolID==f?(typeof a[e]=="undefined"&&(a[e]=t.getUncriticalSymbol(e)),i[u]=a[e]):i[u]=w(symbolID);return i}function w(e){return typeof i.bonus!="undefined"&&typeof i.bonus[e]!="undefined"&&$.inArray(e,u)!=-1?i.bonus[e]:s[e]}function E(e){for(var t in i)for(var n in i[t])if(i[t][n]==e)return parseInt(n)}var t=this,n=null,r=null,i=null,s=null,o={},u=[],a={},f=1e3,l=null,c=ReelSymbolFaker.PLACEHOLDER_NONE,h=[],p=null,d=null,v=null,m=[],g=[];(function(e){i=e.symbols||null,s=i&&i.base?i.base:null,n=e.reels||null;if(n&&n.base){r=n.base;for(var t in r)o[t]=0}var u=0;if(typeof e.criticalSymbols=="object")for(var a in e.criticalSymbols){var f=e.criticalSymbols[a];if(!u||f<u)u=f;for(var c in i){var h=i[c][f];typeof h!="undefined"&&$.inArray(h,g)===-1&&g.push(h)}}if(u)for(id=1;id<u;id++)m.push(id);l=e.placeholderTypes||ReelSymbolFaker.PLACEHOLDER_NONE,typeof e.possibleInitialPlaceholderSymbols!="undefined "&&(p=e.possibleInitialPlaceholderSymbols),d=e.reelReplacementFunction||null})(e),this.setSpinMode=function(e){r=n&&n[e]?n[e]:null,s=i&&i[e]?i[e]:null,c=l&&l[e]?l[e]:ReelSymbolFaker.PLACEHOLDER_NONE,h=p&&p[e]?p[e]:[]},this.setBonusSymbols=function(e){u.length&&t.clearBonusSymbols();for(var n in e)u.push(e[n])},this.clearBonusSymbols=function(){while(u.length)u.pop()},this.checkForReelReplacementSymbols=function(e){typeof d=="function"&&(v=d(e))},this.setPlaceholderSymbols=function(e,t){var n=!1;for(var i in e)n=!0,a[i]=w(e[i]);if(!n)if(c==ReelSymbolFaker.PLACEHOLDER_USE_BONUS_SYMBOL&&u.length==1){var s=w(u[0]);for(var i in r)a[i]=s}else{var o=0,f="";for(var i in t){c==ReelSymbolFaker.PLACEHOLDER_INDEPENDENT_PER_REEL&&(o=0,f="");var l=t[i],h=0,p="";for(var d in l)!p||l[d]!=p?(h>o&&(o=h,f=p),h=1,p=l[d]):h++;h>o&&(f=p),a[i]=f}if(c==ReelSymbolFaker.PLACEHOLDER_ONE_FOR_ALL_REELS)for(var i in a)a[i]=f}},this.initPlaceholderSymbols=function(e,n){a={};if(c==ReelSymbolFaker.PLACEHOLDER_USE_BONUS_SYMBOL&&u.length==1){var i=w(u[0]);for(var s in r)a[s]=i}else{var o=function(e){if(!h.length)return t.getUncriticalSymbol(e);var n=~~(h.length*Math.random());return w(h[n])},f=o();for(var s in r)a[s]=c==ReelSymbolFaker.PLACEHOLDER_ONE_FOR_ALL_REELS?f:o(s)}},this.initReels=function(){t.checkForReelReplacementSymbols(),o=y();for(var e in o){var n=o[e],i=r[e].length,s=0;while($.inArray(r[e][n],m)===-1&&s<i)n=(n+1)%i,s++;o[e]=n}},this.getSymbols=function(e){if(!r||!s)return;var t={};for(var n in r)t[n]=b(n,e);return t},this.getSlotface=function(e){var n=y(),i={},s=0;for(var o in r){var u=r[o];i[s]=[];for(var l=0;l<e;l++){var c=v&&v[o]?v[o]:u[(n[o]+l)%u.length],h=w(c);c==f&&(typeof a[o]=="undefined"&&(a[o]=t.getUncriticalSymbol(o)),h=a[o]),i[s][l]=h}s++}return i},this.checkTransitionOfSymbols=function(e){if(!g.length)return;var n=[];for(var r in e)if($.inArray(e[r][0],g)!==-1){var i=t.getUncriticalSymbol(r);e[r][0]=i,n.push(E(i))}else n.push(E(e[r][0]));return n},this.getUncriticalSymbol=function(e){if(!g.length)return;var t=e&&v&&v[e]?v[e]:m[~~(m.length*Math.random())];return w(t)}}ReelSymbolFaker.PLACEHOLDER_NONE=0,ReelSymbolFaker.PLACEHOLDER_INDEPENDENT_PER_REEL=1,ReelSymbolFaker.PLACEHOLDER_ONE_FOR_ALL_REELS=2,ReelSymbolFaker.PLACEHOLDER_USE_BONUS_SYMBOL=3;