/**
 * class for simulating sounds (settings timouts without playing sounds)
 * @copyright LoCoNET GmbH 2013-2014
 */function SoundFaker(params){function onEndBGSound(e){e==bgIsPlaying&&(bgStopTimer=!1,typeof bgCallback=="function"&&bgCallback(),bgIsPlayingOnLoop?bgStopTimer=setTimeout(function(e){return function(){onEndBGSound(e)}}(bgIsPlaying),map.bg[bgIsPlaying].dur):(bgCallback=!1,bgIsPlaying=!1))}var thiz=this,sounds={},fgCallbacks={},fgIsPlaying={},fgIsPlayingOnLoop={},fgFadeout={},defaultFgSound="fg",bgIsMuted=!1,bgCallback=!1,bgIsPlaying=!1,bgIsPlayingOnLoop=!1,bgFadeout=!1,map={},bgStopTimer=!1;(function(e){for(key in e.soundfiles){var t=e.soundfiles[key].type;map[t]=e.soundfiles[key].map;if(t!="bg"){var n=t;fgCallbacks[n]=null,fgIsPlaying[n]=!1,fgIsPlayingOnLoop[n]=!1,fgFadeout[n]=!1}}if(typeof e.onLoaded=="function")e.onLoaded();else if(typeof e.onProgress=="function"){var r=0;for(key in e.soundfiles)++r;e.onProgress(r)}})(params),this.playBgSound=function(e,t,n){typeof n=="undefined"&&(n=!1),bgIsPlayingOnLoop=n,bgIsPlaying=e,bgCallback=typeof t=="function"?t:null,bgStopTimer&&clearTimeout(bgStopTimer),bgStopTimer=setTimeout(function(e){return function(){onEndBGSound(e)}}(bgIsPlaying),map.bg[bgIsPlaying].dur)},this.stopBgSound=function(){bgIsPlaying&&(bgCallback=!1,bgIsPlaying=bgIsPlayingOnLoop=!1,bgStopTimer&&(clearTimeout(bgStopTimer),bgStopTimer=!1),bgFadeout&&(clearTimeout(bgFadeout),bgFadeout=!1))},this.fadeToStopBgSound=function(e){bgIsPlaying&&(bgCallback=!1,bgFadeout&&clearTimeout(bgFadeout),bgFadeout=setTimeout(function(){bgIsPlaying=bgIsPlayingOnLoop=!1,bgFadeout=!1,bgStopTimer&&(clearTimeout(bgStopTimer),bgStopTimer=!1)},e))},this.fadeToStopFgSound=function(e,t){typeof t=="undefined"&&(t=defaultFgSound),fgIsPlaying[t]&&(fgCallbacks[t]=!1,fgFadeout[t]&&clearTimeout(fgFadeout[t]),fgFadeout[t]=setTimeout(function(){fgIsPlaying[t]=fgIsPlayingOnLoop[t]=!1,fgFadeout[t]=!1},e))},this.muteBgSound=function(e){bgIsMuted=!0},this.setBgSoundVolume=function(e){},this.unmuteBgSound=function(e){bgIsMuted=!1},this.isBgMuted=function(){return bgIsMuted},this.play=function(params){var playwhat=params.playwhat,soundLine=typeof params.soundLine!="undefined"&&params.soundLine?params.soundLine:defaultFgSound,callback=typeof params.callback=="function"?params.callback:null,callbackTime=typeof params.callbackTime!="undefined"?params.callbackTime:0,loop=typeof params.loop=="undefined"?!1:params.loop;fgCallbacks[soundLine]&&(clearTimeout(fgCallbacks[soundLine]),fgCallbacks[soundLine]=!1),fgIsPlaying[soundLine]&&(fgIsPlaying[soundLine]=fgIsPlayingOnLoop[soundLine]=!1),fgIsPlayingOnLoop[soundLine]=loop,fgIsPlaying[soundLine]=playwhat,callback&&(fgCallbacks[soundLine]=function(callback){return setTimeout(function(){fgCallbacks[soundLine]=!1,callback()},callbackTime?typeof callbackTime=="string"?eval(map[soundLine][playwhat].dur+callbackTime):callbackTime:map[soundLine][playwhat].dur)}(callback))},this.playGeneric=function(e,t){typeof t=="undefined"&&(t=!1);if(t&&!fgIsPlaying[t])thiz.play({soundLine:t,playwhat:e});else for(var n in fgIsPlaying)if(!fgIsPlaying[n]){thiz.play({soundLine:n,playwhat:e});break}},this.stop=function(e){typeof e=="undefined"&&(e=!1);for(var t in fgIsPlaying){if(e&&t!=e)continue;fgCallbacks[t]&&(clearTimeout(fgCallbacks[t]),fgCallbacks[t]=!1),fgIsPlaying[t]&&(fgIsPlaying[t]=!1),fgIsPlayingOnLoop[e]=!1}},this.soundOff=function(){},this.soundOn=function(){},this.getActiveBGSound=function(){return bgIsPlaying},this.getActiveSound=function(e){return typeof e=="undefined"&&(e=defaultFgSound),fgIsPlaying[e]},this.setDefaultSoundLine=function(e){defaultFgSound=e}};