/**
 * class for managening the win lines animatino
 * @copyright LoCoNET GmbH 2014-05-30
 */function WinLines(e){function nt(e,t){return e=="undefined"?(trigger.error("actwinlinetoshow issnt set"),-1):(--e,e==-1?0:e>=C?(e-=C,typeof N[e]=="undefined"?-1:N[e][t-1]):typeof T[e]=="undefined"?-1:T[e][t-1])}function rt(){var e=h[l][0],t=e==0&&W;j=[];var r=[];for(var i=1;i<=o;i++)r.push(i);if(e==0&&U){for(var i in U)r.push(U[i][0]);z=!0}else if(z){z=!1;for(var i in U){var u=U[i][0];Y.find("._wlid_frame"+u+",._wlid_winsymbol"+u+",._wlid_gloss"+u).css("opacity",0)}}z;var a="";for(var d=0;d<s;d++)a+="_wl_reelPos"+d+" ";for(var i in r){var v=r[i],m=v,g=Y.find("._wlid_frame"+v),y=Y.find("._wlid_winsymbol"+v),b=Y.find("._wlid_gloss"+v),w=typeof h[l][v]!="undefined"&&h[l][v];!e&&!t&&(w=v>1&&v<o||v>o,m=v-1,m>3&&(m-=o));if(!w){g.css("opacity",0),y.css("opacity",0),b.css("opacity",0);continue}var E=!1,S="",x=0;if(v<=o){t?$.isArray(W[0])||(x=W[v-1]):x=nt(e,v),S={opacity:1};var T=H[x]+"px";g.css("top")!=T&&(S.top=T),E=f&&$.inArray(h[l][m],f)!=-1}else S={opacity:1};y.removeClass(a).addClass("_wl_reelPos"+x);var N=!1,k=!1;if(E){var L=classAdd=!1;x==0?(L="big bigBottom",classAdd="bigTop",N="bigTop",k="t"):x>0&&x<s-1?(L="bigTop bigBottom",classAdd="big",N="big",k="b"):x==s-1&&(L="big bigTop",classAdd="bigBottom",N="bigTop",k="m"),g.removeClass(L).addClass(classAdd),y.removeClass(L).addClass(classAdd),b.removeClass(L).addClass(classAdd),q[v]=N}else g.removeClass("big bigTop bigBottom"),y.removeClass("big bigTop bigBottom"),b.removeClass("big bigTop bigBottom"),q[v]=!1;var A=N=="big"?"b":N=="bigTop"?"t":"",O=0;tt?O=tt(e):e<C&&(O=e);var M=n.getCachedImg(et+"winframe"+O+A);M&&g.css("background-image","url("+M.src+")"),g.css(S);var _=h[l][m],B=!P||$.inArray(_,D)==-1;if(k){var F=_.split(".");_=F[0]+k+"."+F[1]}B?(M=n.getCachedImg(_),M&&y.css("background-image","url( "+M.src+")")):y.css("background-image","none");if(p&&typeof p[l]!="undefined"&&p[l][m])if(y.html())y.find("img").attr("src",p[l][m].src);else{var I=$("<img>");I.attr("src",p[l][m].src),y.html("").append(I)}else y.html("");y.css(S),b.css(S),j.push(v)}if(e!=0&&e<C){var M=n.getCachedImg(et+"winline"+e);M&&c.css("background-image","url("+M.src+")"),c.css("opacity",1)}else c.css("opacity",0)}function it(){if(!d)return!1;var e=Date.now();if(g){var t=e-b-w,n=m[y],r=m[y+1];t>=n&&(typeof r=="undefined"?(y=0,r=n):y++,t>n+r?w=e-b:w+=n,v())}else{var t=e-b-w;t>=m&&(t>2*m?w=e-b:w+=m,v())}if(_){t=(e-b)%1333;var i={};for(var s in j){var u=q[j[s]];u?i[u]={}:i.normal={}}for(var u in i)for(var a in F[u]){var f=F[u][a];if(f[2]>t||f[3]<t)continue;var l=(t-f[2])/(f[3]-f[2]),c=Math.floor(f[4]+(f[5]-f[4])*l),h=null;L?h=c-I[f[0]]+"px":h=c+"px",i[u][a]=h}for(var s in j){var u=q[j[s]]?q[j[s]]:"normal";for(var a in F[u]){var h=i[u][a],f=F[u][a];if(L){var p=(f[1]=="left"?h:"0")+", "+(f[1]=="left"?"0":h);A?B[j[s]][f[0]].css(L,"translate3d("+p+",0)"):B[j[s]][f[0]].css(L,"translate("+p+")")}else B[j[s]][f[0]].css(f[1],h)}}}if(O){var E=[0,0,0,0,0],S=t,x=!0;t<=67?E[4]=1:t<=167?E[4]=1-(t-66)/100:t<=1233?E[4]=0:E[4]=(t-1233)/100;for(var a=0;a<4;++a){if(!x)break;S<=99?E[a]=S/99:S<=231?E[a]=1:S<=297&&(E[a]=1-(S-231)/66),S<330&&(x=!1),S-=330}for(var s in j){var T=B[j[s]];for(var a=1;a<=o;++a)T["sparkle"+a].css("opacity",E[a-1])}}return!0}function st(){if(!J)return!1;var e=(Date.now()-K)%700;for(var t in F.att){var n=F.att[t];if(n[2]>e||n[3]<e){V[n[0]].css("opacity",0);continue}var r=(e-n[2])/(n[3]-n[2]),i=Math.floor(n[4]+(n[5]-n[4])*r);if(L){var s=i-Q[n[0]]+"px",o=(n[1]=="left"?s:"0")+", "+(n[1]=="left"?"0":s);A?V[n[0]].css(L,"translate3d("+o+",0)"):V[n[0]].css(L,"translate("+o+")")}else V[n[0]].css(n[1],i+"px");V[n[0]].css("opacity",1)}var u=[0,0,0,0],a=e;for(var t=1;t<=4&&a>=0;++t)a<=67?u[t-1]=1:a<=200&&(u[t-1]=(200-a)/133),a-=167;for(var t=1;t<=4;++t)V["sparkle"+t].css("opacity",u[t-1]);return!0}function ot(){if(!J)return!1;var e=(Date.now()-K)%567,t=[];for(var n in F.fire){var r=F.fire[n];if($.inArray(r[0],t)!==-1)continue;if(r[2]>e||r[3]<e){V[r[0]].css("opacity",0);continue}t.push(r[0]);var i=(e-r[2])/(r[3]-r[2]),s=Math.floor(r[4]+(r[5]-r[4])*i);if(L){var o=s-Q[r[0]]+"px",u=(r[1]=="left"?o:"0")+", "+(r[1]=="left"?"0":o);A?V[r[0]].css(L,"translate3d("+u+",0)"):V[r[0]].css(L,"translate("+u+")")}else V[r[0]].css(r[1],s+"px");V[r[0]].css("opacity",1)}var a=[0,0],f=e;f<67?a[0]=f/67:f<333?a[0]=1:f<400&&(a[0]=(400-f)/67),f>133&&f<500&&(f<200?a[1]=1-(200-f)/67:f<433?a[1]=1:a[1]=(500-f)/67);for(var n=1;n<=2;++n)V["sparkle"+n].css("opacity",a[n-1]);return!0}function ut(){if(!J)return!1;var e=(Date.now()-K)%667,t=[];for(var n in F.specAtt){var r=F.specAtt[n];if($.inArray(r[0],t)!==-1)continue;if(r[2]>e||r[3]<e){for(var i in G)V[i][r[0]].css("opacity",0);continue}t.push(r[0]);var s=(e-r[2])/(r[3]-r[2]),o=Math.floor(r[4]+(r[5]-r[4])*s);if(L)for(var u in G){var a=o-Q[u][r[0]]+"px",f=(r[1]=="left"?a:"0")+", "+(r[1]=="left"?"0":a);A?V[u][r[0]].css(L,"translate3d("+f+",0)"):V[u][r[0]].css(L,"translate("+f+")")}else for(var i in G)V[i][r[0]].css(r[1],o+"px");for(var i in G)V[i][r[0]].css("opacity",1)}var l=[0,0,0,0],c=e;c<133?l[0]=.8*(1-c/133):c>633&&(l[0]=.5+.5*((c-633)/33)),c<66?l[1]=c/66:c<233&&(l[1]=(233-c)/167),c>200&&c<433&&(c<267?l[2]=1-(267-c)/67:l[2]=(433-c)/166),c>367&&c<600&&(c<433?l[3]=1-(433-c)/66:l[3]=(600-c)/167);for(var n=1;n<=4;++n)for(var i in G)V[i]["sparkle"+n].css("opacity",l[n-1]);return!0}function at(){++l;if(l>=h.length){if(Z&&!Z())return;l=0}rt(),x&&x(h[l][0])}function ft(){++l;if(!g&&l==h.length-1)E||(m=500);else if(l>h.length-1){if(Z&&!Z())return;t.startWinLines(x)}rt(),S&&S(h[l][0])}var t=this,n=null,r=null,i=1067,s=0,o=0,u=0,a=0,f=!1,l=-1,c=null,h=[],p=null,d=!1,v=!1,m=0,g=!1,y=0,b=0,w=0,E=!1,S=null,x=null,T=null,N=null,C=1e3,k=["a","b","c","d","e"],L=!1,A=!1,O=!0,M=!0,_=!0,D=null,P=!1,H=null,B={},j=[],F=null,I={},q=[!1,!1,!1,!1],R=null,U=null,z=!1,W=!1,X=!1,V=null,J=!1,K=0,Q=null,G=[],Y=null,Z=null,et="",tt=null;(function(e){var t=e.slotConf,l=e.devConf;Y=$(typeof e.domID=="undefined"?"#winlines_container":e.domID),typeof e.repeatWinLineCycle=="function"&&(Z=e.repeatWinLineCycle),typeof e.cacheImgPraef!="undefined"&&(et=e.cacheImgPraef),typeof e.winFrameNumberGetter=="function"&&(tt=e.winFrameNumberGetter),n=e.cache,r=e.animManager;if(L=l.getSupportedTransform())A=l.use3DTransform();O=l.useWinframeSparkles()&&t.feature("sparkles"),M=t.feature("gloss"),_=M&&l.animWinframeGloss(),c=Y.find("._wlid_winline"),R=Y.find("._wl_hideElem");var h=Y.find("._wlid_gloss");M||(R=R.not(h),h.css("opacity",0)),u=t.size("sH"),a=t.size("sWs"),H=[0,u,2*u,3*u],F=t.size("wfa"),T=t.winlines(),s=e.slotConf.rows(),o=e.slotConf.reels(),typeof e.bigSymbol!="undefined"&&(f=$.isArray(e.bigSymbol)?e.bigSymbol:[e.bigSymbol]),typeof e.noWinframeSymbolsDuringAnim!="undefined"&&l.playSymbolAnims()&&(D=$.isArray(e.noWinframeSymbolsDuringAnim)?e.noWinframeSymbolsDuringAnim:[e.noWinframeSymbolsDuringAnim],P=!0),typeof e.intervalWinLine!="undefined"&&(i=e.intervalWinLine);if(typeof e.specials!="undefined"){U=e.specials;var p=Y.find("._wlid_winsymbols"),d=Y.find("._wlid_frames");for(var v in U){var m=U[v],g="top: "+H[m[2]]+"px; left: "+a*(m[1]-1)+"px; opacity:0;",y=$("<div></div>",{"class":"_wlid_winsymbol"+m[0]+" _wl_symbol",style:g});y.appendTo(p);var b=$("<div></div>",{"class":"_wlid_frame"+m[0]+" _wl_symbol",style:g});b.appendTo(d);if(M){var w=$("<div></div>",{"class":"_wlid_gloss"+m[0]+" _wl_symbol",style:g});w.appendTo(h)}}}})(e),this.setWinLines=function(e,t){h=e,p=t},this.getPosition=function(e,t){return T[e-1][t]},this.getReelIdx=function(e){return k[e]},this.onInitialized=function(e){X=e.attention;var t=["1a","1b","2a","2b","3a","3b","4a","4b"],n=[];for(var r=1;r<=o;r++)n.push(r);if(U)for(var r in U)n.push(U[r][0]);for(var r in n){var i=n[r],s=Y.find("._wlid_gloss"+i).html("").css("opacity",0),u=$("<div></div>",{"class":"boxGloss",style:"overflow: hidden;"});u.appendTo(s);var a={c:s};for(var f in t){var l=$("<div></div>",{"class":"wGloss wGloss"+t[f]});l.appendTo(u),a[t[f]]=l;if(i==1){var c=t[f].substr(0,1);I[t[f]]=parseInt(l.css(c=="1"||c=="3"?"left":"top"))}}if(O)for(var h=1;h<=o;++h){var p=$("<div></div>",{"class":"boxSparkle boxSparkle"+h});p.appendTo(s),a["sparkle"+h]=p}B[i]=a}if(X){Q={},V={};if(X=="scatter"){var d=["1","2a","2b","3","4a","4b"];for(var r in d){var v=d[r];V[v]=Y.find("._wlid_attention .wAtt"+v),Q[v]=parseInt(V[v].css(v=="1"||v=="3"?"left":"top"))}for(var r=1;r<=4;++r)V["sparkle"+r]=Y.find("._wlid_attention .boxSparkle"+r)}else if(X=="specialsymbol"||X=="specialsymbol2"){var d=["1","2","3","4"];for(var r=0;r<3;++r){V[r]={},Q[r]={};for(var h in d){var v=d[h];V[r][v]=Y.find("._wlid_specialattention #_wl_specatts"+(r+1)+" .wSpAtt"+v+" .inner"),Q[r][v]=parseInt(V[r][v].css(v=="1"||v=="3"?"left":"top"))}for(var h=1;h<=4;++h)V[r]["sparkle"+h]=Y.find("._wlid_specialattention #_wl_specatts"+(r+1)+" .boxSparkle"+h)}}else if(X=="fire"){var d=["1","2","3","4"];for(var h in d){var v=d[h];V[v]=Y.find("._wlid_fireattention .wFiAtt"+v+" .inner"),Q[v]=parseInt(V[v].css(v=="1"||v=="3"?"left":"top"))}for(var h=1;h<=2;++h)V["sparkle"+h]=Y.find("._wlid_fireattention .boxSparkle"+h)}}},this.startLinePings=function(e,t,n,i){S=null,x=typeof t=="function"?t:null,l=-1,m=typeof n=="undefined"||!n?300:n,g=m&&$.isArray(m),y=0,v=ft,E=typeof i!="undefined"&&i,d=!0,w=0,b=Date.now(),R.css("opacity",1),ft(),S=e,r.add("winline"+et,it)},this.startWinLines=function(e){l=-1,m=i,g=!1,v=at,x=typeof e=="function"?e:null,d||(d=!0,w=0,b=Date.now(),r.add("winline"+et,it)),R.css("opacity",1),at()},this.stop=function(){d=!1,R.css("opacity",0)},this.startAttention=function(e){if(X!="scatter"&&X!="fire"){console.error("scatter attention animation is not initialized!");return}J||(J=!0,K=Date.now()),X=="scatter"?(Y.find("._wlid_attention").css("left",e*a+"px"),r.add("attention"+et,st),Y.find("._wlid_attentions").css("opacity",1)):X=="fire"&&(Y.find("._wlid_fireattention").css("left",e*a+"px"),r.add("fire"+et,ot),Y.find("._wlid_fireattentions").css("opacity",1))},this.stopAttention=function(){J=!1,X=="scatter"?Y.find("._wlid_attentions").css("opacity",0):X=="fire"&&Y.find("._wlid_fireattentions").css("opacity",0)},this.startSpecialAttention=function(e,t){if(X!="specialsymbol"&&X!="specialsymbol2"){console.log("special attention animation is not initialized!");return}J||(J=!0,K=Date.now()),Y.find("._wlid_specialattention").css("left",e*a+"px"),G=t;for(var n=0;n<3;++n)G[n]?Y.find("._wlid_specialattentions #_wl_specatts"+(n+1)).css("opacity",1):Y.find("._wlid_specialattentions #_wl_specatts"+(n+1)).css("opacity",0);r.add("special"+et,ut),Y.find("._wlid_specialattentions").css("opacity",1)},this.stopSpecialAttention=function(){J=!1,Y.find("._wlid_specialattentions").css("opacity",0)},this.setFreeGameTriggers=function(e){W=e},this.setWinLinesBlend=function(e){p=e},this.setNoWinframeSymbolsDuringAnimFeature=function(e){D!=null&&(P=e,d&&rt())},this.setAnimWinframeGloss=function(e){_=e},this.setSpecialWinLinesConfig=function(e){N=e}};