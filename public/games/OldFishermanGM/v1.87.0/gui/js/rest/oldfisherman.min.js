function SlotMachine(e){function H(){i=new HypeManager({}),$("#loading .progress").html("100%"),$("#loading .state").show(),obj_restHandler.requestInit()}function B(e,t,r){var i={},s={},u={wild:{loop:!0},scatterBonus:{loop:!1,onEnd:t,endDelay:r}};for(var a in e.freeGamesAnimations){var f=e.freeGamesAnimations[a],l=f.animation;typeof i[l]=="undefined"&&(i[l]=[],s[l]=u[l]),i[l].push({x:n.size("sWs")*f.reel,y:n.size("sH")*f.pos,elem:$("#reel_"+o.getReelIdx(f.reel)+"_"+(n.rows()-f.pos))})}e.prepareAnim(i),e.startAnim(s)}function j(e){obj_restHandler.processResponse(e);if(typeof e.initData!="undefined"){typeof e.initData.reeltiming=="string"&&(m=e.initData.reeltiming);var h={base:{1:"/symbol-9.jpg",2:"/symbol-10.jpg",3:"/symbol-j.jpg",4:"/symbol-q.jpg",5:"/symbol-k.jpg",6:"/symbol-a.jpg",7:"/symbol-compass.jpg",8:"/symbol-pipe.jpg",9:"/symbol-barrels.jpg",10:"/symbol-boat.jpg",11:"/symbol-wild.png",12:"/symbol-fish.jpg",winLines:{11:"/wild_small.png"}},free:{1:"/symbol-9.jpg",2:"/symbol-10.jpg",3:"/symbol-j.jpg",4:"/symbol-q.jpg",5:"/symbol-k.jpg",6:"/symbol-a.jpg",7:"/symbol-compass.jpg",8:"/symbol-pipe.jpg",9:"/symbol-barrels.jpg",10:"/symbol-boat.jpg",11:"/symbol-wild.png",12:"/symbol-fish.jpg",winLines:{11:"/wild_small.png"}}},N={base:{a:[5,2,12,3,4,6,7,3,4,8,3,4,7,5,10,1,4,6,12,5,4,3,9,4,5,9,2,5,1,7,5,2,3,10,4,1e3,1e3,1e3,1e3,1e3,1e3],b:[2,7,4,2,10,4,6,9,5,3,10,6,7,1,6,12,3,7,6,1,8,5,10,4,11,3,9,4,2,10,5,8,6,1e3,1e3,1e3,1e3,1e3,1e3,1e3],c:[2,9,6,7,4,5,7,6,11,4,9,6,8,3,9,6,8,9,3,10,4,8,8,5,12,2,8,4,5,7,6,2,9,1,9,6,7,4,8,2,1e3,1e3,1e3,1e3,1e3,1e3,1e3],d:[1,10,6,8,11,5,9,1,8,4,9,2,8,3,4,7,2,8,1,7,2,10,3,9,6,8,2,12,3,10,5,7,8,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3],e:[5,8,3,10,4,6,9,3,9,12,3,6,8,1,5,8,3,11,5,7,1,9,3,8,9,2,5,9,6,10,2,1,7,1,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3]},free:{a:[6,7,8,2,1,4,8,5,7,2,6,12,4,5,10,1,3,10,2,12,4,7,3,9,5,9,4,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3],b:[9,2,10,5,8,6,4,3,9,4,2,11,6,7,4,5,3,10,6,7,1,6,12,3,7,6,1,8,5,10,2,10,4,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3],c:[8,5,12,2,8,6,8,3,9,6,1,8,5,7,6,11,4,9,3,10,4,8,4,5,7,6,2,9,6,7,4,8,2,7,4,9,2,9,6,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3],d:[1,10,6,8,6,2,12,3,10,4,7,2,8,1,7,2,8,11,5,9,3,8,2,10,3,9,5,7,1,8,4,9,2,8,3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3],e:[6,8,1,11,5,8,3,10,4,1,7,9,2,1,5,7,9,6,10,2,1,9,3,8,5,9,12,3,6,9,3,5,8,3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3,1e3]}},C=[11,12],H={base:[1,2,3,4,5,6,7,8,9,10],free:[7,8,9,10]};obj_restHandler.onSoundLoaded(e.initData.sound),o=new WinLines({cache:r,devConf:t,slotConf:n,animManager:l,bigSymbol:["/wild_small.png"]}),u=new FreeGame({conf:n,devConf:t,sound:s,getReelIdx:o.getReelIdx,scatter:12,animBG:"scatterBonus",animFG:"scatterBonus",renderFreegameSign:F,animManager:l,lang:A}),a=new ReelEngine({sound:s,cache:r,conf:t,animManager:l,finishListener:!0,container:"reel_hype_container",size:{w:n.size("sW"),h:n.size("sH")},reelSpace:n.size("sp"),scatter:["/symbol-wild.png"],scatterParams:{h:n.size("scH")+"px",m:n.size("scO")+"px"},speed:n.speed(m),rows:n.rows(),symbols:["/symbol-9.jpg","/symbol-10.jpg","/symbol-j.jpg","/symbol-q.jpg","/symbol-k.jpg","/symbol-a.jpg","/symbol-compass.jpg","/symbol-pipe.jpg","/symbol-barrels.jpg","/symbol-boat.jpg","/symbol-wild.png","/symbol-fish.jpg"],fakeReels:N,fakeReelSymbols:h,fakeCriticalSymbols:C,placeholderTypes:{base:ReelSymbolFaker.PLACEHOLDER_ONE_FOR_ALL_REELS,free:ReelSymbolFaker.PLACEHOLDER_ONE_FOR_ALL_REELS},possibleInitialPlaceholderSymbols:H}),a.init(),obj_anim=new SlotMachineAnim({hype:i,sound:s,cache:r,conf:n,devConf:t,winLines:o,reelEngine:a,animManager:l,freeGame:u,winanim:v,linepings:!1,ambienteSound:!g,stereo:!0,symbolTeaserAnim:!1,animations:p,optimalSlotAnimations:O,optimalSlotBigAnimData:{wild:{h:n.size("scH")+"px",o:n.size("scO")+"px"}},symbols:h,symbolTeaserReels:!1,playFreegameIntro:!0,ownFunctions:{sfg:function(e){var n=t.playSymbolAnims(),r=function(){var t=function(){$(".headlineContainer").addClass("plain"),$("#freegame_container").hide().addClass("intro").show(),s.play({playwhat:"fanfare"}),e.changeSymbols(),e.onFreegameIntroPause(function(){$(".headlineContainer").removeClass("plain"),e.startFreegame(),$("#freegame_container").hide().removeClass("intro").html("")})};F("intro",t,e.winFG)};n?(obj_anim.setFixedSymbols([12]),s.play({playwhat:"fgTrigger"}),$("._wlid_darkening").css("opacity",1),B(e,function(){$("._wlid_darkening").css("opacity",0),r()},1100)):setTimeout(r,600)},rfg:function(e){var n=t.playSymbolAnims(),r=function(){M=!1,$("#freegame_container").hide().removeClass("retrigger").html(""),$("._wlid_darkening").css("opacity",0),e.continueFreegame()},i=function(){var t=function(){M=!0;var t=Date.now()+3e3,n=!1,i=function(){return M?(n&&Date.now()>=t&&r(),!0):!1};l.add("finishRetriggerTimeout",i),s.play({playwhat:"fanfare",callback:function(){n=!0}}),$("#freegame_container").hide().addClass("retrigger").show(),e.onAbortable(r)};F("retrigger",t,e.winFG)};s.muteBgSound(!0),n?(obj_anim.setFixedSymbols([12]),$("._wlid_darkening").css("opacity",1),s.play({playwhat:"fgTrigger"}),B(e,i,900)):setTimeout(function(){$("._wlid_darkening").css("opacity",1),i()},600)},gbp:function(e){if(e.winLine){var t={},n=o.getPosition(e.winLine,e.reel)+1;if(e.frp[n-1]==11)return e.frp[n+1]==11?(t[e.reel+1]=r.getCachedImg("symBlendTopBottom"),t):(t[e.reel+1]=r.getCachedImg("symBlendTop"),t);if(e.frp[n+1]==11)return t[e.reel+1]=r.getCachedImg("symBlendBottom"),t}return!1}}}),obj_restHandler.enableManualReels({halfsize:t.mode("r"),rows:n.rows(),reelSymbols:h,anim:obj_anim,reelEngine:a}),obj_console=new OnlineConsole({devConf:t,sound:s,animManager:l,onMoneySet:obj_restHandler.onMoneySet,spacebarActivated:e.initData.spaceBar,quickSpin:e.initData.quickSpin,leftHandMode:e.initData.leftHandMode,featureCountdown:e.initData.featureCountdown,requestSender:f.sendRequest,featureCountdownType:"freegame",bottomNotClickable:!t.isBottomAreaClickable(),alwaysShowVersionAndSlotname:x,numInputTypeForMobile:t.getNumericInputTypeForMobile()}),obj_slotmachineController=new SlotmachineController({requestSender:f.sendRequest,console:obj_console,anim:obj_anim,sound:s,loader:r,devConf:t,animManager:l,restHandler:obj_restHandler,layout169:d,hasPauseInFreegameIntro:!0,ambienteSound:!g,rulesURL:y,rulesJSLoader:b,loadRulesInClient:w,onPending:E,reeltiming:m,startFullScreen:_,stopFullScreen:D,enabledFullScreen:P,hasBetChangeLoops:T,startGameRound:k,finishGameRound:L,useFakeReels:!0}),obj_restHandler.addCallbacks({deactivateAutoSpin:obj_console.stopAutospin,setLineBets:function(e){obj_slotmachineController.display([{type:"possLinebets",value:e}])},abortWinAnim:function(){obj_console.clickButton("abortwinanim")},getState:obj_console.getState,pauseSlot:obj_slotmachineController.pauseSlot,resumeSlot:obj_slotmachineController.resumeSlot,afterFreeRoundsIntro:obj_slotmachineController.onFreeRoundsIntroClose,ignoreUserInput:obj_console.ignoreUserInput});var j=function(){obj_slotmachineController.init(e.initData),o.onInitialized({attention:e.initData.attentionSpin}),obj_restHandler.onSMReady(),S&&S()};t.useCoinShowers()?(i.addListener({type:i.onDocumentLoaded,callback:function(){c++,c==1&&(j(),i.onInitialized())}}),i.load({name:v})):j()}typeof e.display!="undefined"&&obj_slotmachineController&&obj_slotmachineController.display(e.display)}function F(e,n,r){var i=t.mode("r")==0?2:1;$("#freegame_container").css("opacity",0).show(),$("#freegame_container").append('<div id="fgRenderBox"></div>'),$("#fgRenderBox").append('<div class="multilingualTextEffect textblock" id="'+e+'"></div>');var s=$("#fgRenderBox #"+e),o=obj_lang["game_oldFisherman_fg-"+e];for(var u in o)s.append('<span class="textpart" id="'+e+"-"+u+'">'+o[u]+"</span><br />");s.find("br").last().remove(),typeof r!="undefined"&&$("#freegame_container #fgRenderBox .freegamesAmount").html(r),$("#fgRenderBox").css({position:"static",width:"auto"});var a=s.width()-20*i;s.width("auto");var f=s.width();s.width("");if(f>a){var l=a/f,c=parseInt(s.css("font-size")),h=parseInt(l*c)-1;s.css("font-size",h+"px"),s.find(".textpart").append('<span class="fontsizeFaker" style="font-size:'+parseInt(.9*c)+'px"></span>')}$("#fgRenderBox").css({position:"",width:""}),$("#freegame_container").hide().css("opacity",""),typeof n=="function"&&n()}var t,n,r,i,s,o,u,a,f,l,c=0,h=!1,p=null,d=!1,v="winanim",m="normal",g=!1,y=!1,b=null,w=!1,E=null,S=null,x=!1,T=!0,N=!1,C=!1,k=null,L=null,A="en",O=["wild"],M=!1,_=null,D=null,P=null;this.onShutdown=function(){obj_restHandler.onCloseGame()},function(e){h=e.resolution,p=e.animationData,d=e.layout169,y=e.rulesURL,b=e.rulesJSLoader,typeof e.loadRulesInClient!="undefined"&&(w=e.loadRulesInClient),typeof e.onPending=="function"&&(E=e.onPending),typeof e.onLoaded=="function"&&(S=e.onLoaded),typeof e.lang!="undefined"&&(A=e.lang),typeof e.enforceVersion!="undefined"&&(x=e.enforceVersion),typeof e.hasBetChangeLoops!="undefined"&&(T=e.hasBetChangeLoops),typeof e.showExtraJackpotBet!="undefined"&&(N=e.showExtraJackpotBet),typeof e.showInfoDuringJackpotChance!="undefined"&&(C=e.showInfoDuringJackpotChance),typeof e.startGameRound=="function"&&(k=e.startGameRound),typeof e.finishGameRound=="function"&&(L=e.finishGameRound),typeof e.startFullScreen=="function"&&(_=e.startFullScreen),typeof e.stopFullScreen=="function"&&(D=e.stopFullScreen),typeof e.enabledFullScreen=="function"&&(P=e.enabledFullScreen),t=new DeviceConfig({mode:e.mode}),typeof e.supressAutoFullscreen!="undefined"&&e.supressAutoFullscreen&&t.supressAutoFullscreenDetection(),n=new SlotConfig({devConfig:t,machine:"oldfisherman"}),g=t.useSmallSounds(),v=e.winanim+(t.useCoinShowers()==="optimal"?"opt":""),typeof e.reeltiming!="undefined"&&(m=e.reeltiming),l=new AnimManager,f=new Communicator({slotmachine:"OldFisherman",responseHandler:j,slotConf:n,lablerEventManager:typeof e.lablerEventManager!="undefined"?e.lablerEventManager:!1}),obj_restHandler=new SMRestHandler({requestSender:f.sendRequest,isSoundSettable:e.isSoundSettable,clock:typeof e.showClock=="undefined"?!1:e.showClock,version:typeof e.showVersion=="undefined"?!1:e.showVersion,name:"OLD FISHERMAN",warnBrowser:t.showBrowserWarning(),onFatalError:typeof e.onFatalError=="undefined"?!1:e.onFatalError,lablerEventManager:typeof e.lablerEventManager!="undefined"?e.lablerEventManager:!1}),r=new GameLoader({height:n.size("h"),width:n.size("w"),devConf:t,restHandler:obj_restHandler,baseURL:typeof e.baseURL=="undefined"?"":e.baseURL}),obj_restHandler.isResizable()&&r.autofit();var i=obj_restHandler.getSoundFiles(e.soundFiles,g),o=0;for(var u in i)++o;var a=typeof e.winLines!="undefined"&&e.winLines?e.winLines:20;r.preload({pictures:getPreloadImages(t,n,a,e.lang),onUpdate:typeof e.preload=="function"?e.preload:obj_restHandler.onPreloaderUpdate,onLoaded:H,additionalCounter:o,lang:e.lang,resol:h}),s=obj_restHandler.loadSoundManager({soundVersions:t.getSoundVersions(),soundFiles:i,smallSounds:g,soundFileVersion:e.soundFileVersion,onProgress:r.onExternProgress})}(e)}var obj_restHandler,obj_anim,obj_console,obj_slotmachineController;