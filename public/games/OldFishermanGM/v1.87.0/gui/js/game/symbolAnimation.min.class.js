/**
 * class for managening symbol animations
 * @copyright LoCoNET GmbH 2014-07-08
 */function SymbolAnimation(e){function U(e,t){var r=!1;if(n){var i=n.getCachedImg(e);i&&(t.push(i),r=!0,--c)}r||console.error("animation picture "+e+" not defined in preloader!")}function z(){c>0&&--c}function W(){if(M)for(var e in M){var t=M[e];typeof t=="string"&&(M[e]=$(t))}}function X(e,t){if(!M)return;var n=t!=="all",r=M;n&&(r={},r[t]=!0);if(n&&!M[t])return;if(o==2){if(O.length&&!j&&e==0)for(var i in r){var s=M[i];typeof s=="string"&&(s=$(s)),s.css("background-image","none")}else if(O.length&&e>=(B?B-1:x-1)){for(var i in r){var s=M[i];typeof s=="string"&&(s=$(s)),s.css("background-image","url( "+O[0].src+")")}n?M[t]=null:M=null}else if(!O.length&&F&&!I){I=[],W();for(var i in r){var s=M[i];typeof s=="string"&&(s=$(s)),I.length||(I.push(s.css("background-image")),I.push([])),s.css("background-image","none"),I[1].push(s)}}}else if(O.length&&(e>=6||e>=(B?B-1:x-1))){for(var i in r){var s=M[i];typeof s=="string"&&(s=$(s)),s.css("background-image","url( "+O[0].src+")")}n?M[t]=null:M=null}}function V(){s==2?(K(),r.add("animateMode2"+i,K)):(J(),r.add("animateMode1"+i,J))}function J(){if(!y)return!1;var e=Date.now(),n=parseInt((e-b)*S/1e3);s==3&&l.of&&(n-=l.of);var r=n,i=!L&&(s!=3||q)&&B?B:x;if(r>=i){if(!L){if(s!=3||!!q)return _&&(w||(w=e)),_&&e-w<_?!0:(P&&!G(P,r)&&(P=!1),t.stop(),A&&A(),!1);A&&A(),l.o=f,l.om=o,l.oms=a,l.of=x,n-=l.of,r-=l.of,l.ox=T,l.oy=N,f=l.i,x=l.f,T=l.sX,N=l.sY,C=T*N,o=l.m,a=l.ms,L=!0}else A&&A();r%=x}P&&!G(P,r)&&(P=!1);if(r==k)return!0;var u=Math.floor(r/C),c=r%T,p=Math.floor(r/T)%N;for(var d in h)Q(h[d],n,u,c,p);return k=r,X(r,"all"),!0}function K(){if(!y)return!1;var e=!1;for(var n in h){var r=parseInt((Date.now()-b[n])*S/1e3),i=r;if(i>=x){if(!L){h[n].clearRect(0,0,d,v),X(i,n),P[n]&&!G(P[n],i)&&(P[n]=!1);continue}i%=x}e=!0;if(i==k[n])continue;P[n]&&!G(P[n],i)&&(P[n]=!1),Q(h[n],r,Math.floor(i/C),i%T,Math.floor(i/T)%N),k[n]=i,X(i,n)}return e?!0:(t.stop(),!1)}function Q(e,t,n,r,i){e.clearRect(0,0,d,v),e.globalCompositeOperation="copy",o==1?(e.drawImage(a[0],0,0),e.globalCompositeOperation="source-in"):o==2&&(!u||u>t)&&(e.drawImage(a[n],d*r,v*i,d,v,0,0,d,v),e.globalCompositeOperation="source-in"),e.drawImage(f[n],d*r,v*i,d,v,0,0,d,v),e.globalCompositeOperation="copy"}function G(e,t){var n=!1;for(var r in e)r<=t?(e[r](),delete e[r]):n=!0;return n}var t=this,n=null,r=null,i=null,s=0,o=0,u=0,a=[],f=[],l={},c=0,h=[],p=[],d=0,v=0,m=0,g=0,y=!1,b=0,w=0,E=0,S=0,x=0,T=0,N=0,C=0,k=0,L=!0,A=null,O=[],M=null,_=0,D=null,P=!1,H=!1,B=!1,j=!1,F=!1,I=!1,q=!1,R=!1;(function(e){i=e.name,o=e.mask,r=e.animManager,s=e.mode,d=e.width,v=e.height,typeof e.offsetX!="undefined"&&(g=e.offsetX),typeof e.offsetY!="undefined"&&(m=e.offsetY),E=e.fps,x=e.frames,typeof e.square!="undefined"?T=N=e.square:(T=e.symbolsX,N=typeof e.symbolsY!="undefined"?e.symbolsY:T),C=T*N,typeof e.indep!="undefined"&&(H=e.indep),typeof e.endFrameNo!="undefined"&&(B=e.endFrameNo),typeof e.hideBG!="undefined"&&(F=e.hideBG),typeof e.disableMaskFrame!==undefined&&(u=e.disableMaskFrame,u>x&&(u=!1)),c=e.maps,o==1?++c:o==2&&(u?c+=Math.floor((u+C-1)/C):c+=e.maps),e.ePict&&++c;if(s==3){c+=e.loopMaps;var h=typeof e.loopMask!="undefined"?e.loopMask:o;h==1?++c:h==2&&(c+=e.maps)}H||(_sanim_runningAnims[i]=t),typeof e.cache=="object"&&(n=e.cache);for(var p=0;p<e.maps;++p)U(i+"_"+p+".jpg",f);if(o==1)U(i+"Mask.png",a);else if(o==2){var y=u?Math.floor((u+C-1)/C):e.maps;for(var p=0;p<y;++p)U(i+"Mask_"+p+".png",a)}e.ePict&&U(i+"End.png",O);if(s==3){l={o:!1,om:!1,oms:!1,of:!1,ox:!1,oy:!1,i:[],f:e.loopFrames,m:h,ms:[]},typeof e.loopSquare!="undefined"?l.sX=l.sY=e.loopSquare:(l.sX=e.loopSymbX,l.sY=typeof e.loopSymbY!="undefined"?e.loopSymbY:l.sX);for(var p=0;p<e.loopMaps;++p)U(i+"Loop_"+p+".jpg",l.i);if(h==1)U(i+"LoopMask.png",l.ms);else if(h==2){var y=u?Math.floor((u+C-1)/C):e.loopMaps;for(var p=0;p<y;++p)U(i+"LoopMask_"+p+".png",l.ms)}}})(e),this.prepare=function(e,n){y&&s!=2&&t.stop();if(!y||s!=2)h=[],p=[],M=[];if(!H)for(var r in _sanim_runningAnims){if(r==i)continue;_sanim_runningAnims[r].isRunning()&&_sanim_runningAnims[r].stop()}typeof n=="undefined"?D=$("._wlid_animBox"):D=n,t.addAnimationPositions(e)},this.addAnimationPositions=function(e){for(var t in e){var n=e[t],r={position:"absolute",display:"block",left:n.x+g+"px",top:n.y+m+"px",width:d+"px",height:v+"px"},i="";typeof n.scale!="undefined"&&(i+="scale( "+n.scale+" )"),typeof n.rotate!="undefined"&&(i+="rotate( "+n.rotate+"deg )"),i&&(r["-webkit-transform"]=i,r["-moz-transform"]=i,r["-ms-transform"]=i,r["-o-transform"]=i,r.transform=i);var s=jQuery("<canvas/>",{css:r});s.attr({width:d,height:v}),s.appendTo(typeof n.contBox!="undefined"?n.contBox:D),h.push(s[0].getContext("2d")),p.push(s),typeof n.elem!="undefined"&&(M||(M=[]),M.push(n.elem))}M&&M.length==0&&(M=null)},this.start=function(e){var t=typeof e=="object",n=t&&typeof e.now!="undefined"?e.now:Date.now();if(s!=2)b=n,w=0,k=-1,P=t&&typeof e.onFrame=="object"?e.onFrame:!1,I=!1,q=t&&typeof e.dontLoopMode3!="undefined"?e.dontLoopMode3:!1;else{y||(b=[],k=[],w=[],P=[]);var r=h.length-b.length;for(var i=0;i<r;++i)w.push(0),b.push(n),k.push(-1),P.push(t&&typeof e.onFrame=="object"?e.onFrame:!1)}s==3&&(l.o&&(f=l.o),l.om&&(o=l.om),l.oms&&(a=l.oms),l.of&&(x=l.of),l.of=!1,l.ox&&(T=l.ox),l.oy&&(N=l.oy),C=T*N),y=!0,A=t&&typeof e.onEnd=="function"?e.onEnd:!1,L=t&&typeof e.loop!="undefined"?e.loop:s!=3,_=t&&typeof e.endDelay!="undefined"?e.endDelay:0,S=t&&typeof e.fps!="undefined"?e.fps:E,j=t&&typeof e.dontRemoveBG!="undefined"?e.dontRemoveBG:!1,R=t&&typeof e.dontClearDrawContainer!="undefined"?e.dontClearDrawContainer:!1,V()},this.stop=function(){if(I){for(var e in I[1]){var t=I[1][e];t.css("background-image",I[0])}I=!1}if(O.length&&M&&s==2){for(var e in h)if(M[e]){var t=M[e];typeof t=="string"&&(t=$(t)),t.css("background-image","url( "+O[0].src+")")}M=null}if(R)for(var e in p)p[e].remove();else D.html("");h=[],p=[],y=!1},this.isRunning=function(){return y}}var _sanim_runningAnims={};