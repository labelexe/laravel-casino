/**
 * class for loading games
 * @copyright LoCoNET GmbH 2013-2014
 */function GameLoader(e){function C(){typeof autoResize=="function"?(o=autoResize(o,i,s,n),u&&(clearTimeout(u),u=!1)):console.error("missing resizeing function!")}function A(e){x=e,y=!0,v=x.length,g=Date.now(),t.add({name:"preloadPictCheck",interval:1e3,func:M});var r=function(){d?d(m,v):$("#loading .state").html(jv_loading1.replace("<X>",m).replace("<Y>",v));var e=n.maxParallelDownloads();e>x.length&&(e=x.length);for(N=1;N<e;++N){var t=x[N],r=new Image;$.isArray(t)?(r.onload=k,r.onerror=L,r.src=f+t[1],T[t[0]]=r,b[r.src]=[1,t[0]]):(r.onload=k,r.onerror=L,r.src=f+t,b[r.src]=[1,!1])}},i=x[0],s=function(){++m,r(),O()},o=new Image;$.isArray(i)?(o.onload=s,o.onerror=s,o.src=f+i[1],T[i[0]]=o):(o.onload=s,o.onerror=s,o.src=f+x[0])}function O(){if(y){var e=m+S+w,n=v+E;d?d(e,n):$("#loading .state").html(jv_loading1.replace("<X>",e).replace("<Y>",n)),e==n?(y=!1,t.remove("preloadPictCheck"),w?_():P()):g=Date.now()}}function M(){var e=Date.now();e-g>2e4&&(y=!1,t.remove("preloadPictCheck"),w=v+E-(m+S),w?_():P())}function _(){var e=$("#errorPopupCode .errorContainer").clone();e.find(".errorPopup").addClass("preloadError"),e.find(".errorPopup .errorText").html(obj_lang.game_error_errorPreload),e.find(".errorPopup .buttonText").html(obj_lang.game_error_buttonNewLoad),e.find(".errorPopup").append('<div class="goToGameButton"><div class="goToGameButtonText"></div></div>'),e.find(".errorPopup .goToGameButtonText").html(obj_lang.game_error_buttonGoToGame),e.appendTo($(".popupContainer")),$(".popupContainer .retry").click(function(){return $(".popupContainer").html(""),r.onFatalError(),!1}),$(".popupContainer .goToGameButton").click(function(){return $(".popupContainer").html(""),P(),!1})}function D(e){for(var t=0,n=e.length;t<n;++t){var r=e[t];$.isArray(r)&&(T[r[0]]=r[1])}h=window.applicationCache,h.addEventListener("cached",H,!1),h.addEventListener("error",H,!1),h.addEventListener("noupdate",H,!1),h.addEventListener("obsolete",H,!1),h.addEventListener("progress",H,!1),h.addEventListener("updateready",H,!1);try{h.update()}catch(i){}}function P(){if(c)return;for(var e in T){var t=T[e];if(typeof t=="string"){var n=new Image;n.src=t,T[e]=n}}p(),c=!0}function H(e){e.type=="noupdate"||e.type=="error"||e.type=="cached"||e.type=="obsolete"?P():e.type=="progress"?d?d(e.loaded,e.total):$("#loading .state").html(jv_loading1.replace("<X>",e.loaded).replace("<Y>",e.total)):e.type=="updateready"&&r.onFatalError()}var t=null,n=null,r=null,i=0,s=0,o=!1,u=!1,a=!1,f="",l=!1,c=!1,h,p,d=null,v=0,m=0,g=0,y=!1,b={},w=0,E=0,S=0,x,T={},N=1;(function(e){t=Timer_getInstance(),n=e.devConf,r=e.restHandler,i=e.height+1,s=e.width+1,n.addAdditionalTopMargin()&&$(".container").css("margin-top","1px"),typeof e.baseURL!="undefined"&&e.baseURL&&(f=e.baseURL)})(e);var k=function(){delete b[this.src],++m,O();if(N<x.length){var e=x[N];++N;if($.isArray(e)){var t=new Image;t.onload=k,t.onerror=L,t.src=f+e[1],T[e[0]]=t,b[t.src]=[1,e[0]]}else{var t=new Image;t.onload=k,t.onerror=L,t.src=f+e,b[t.src]=[1,!1]}}},L=function(){if(typeof b[this.src]=="undefined"){console.error("unregistered failed loader "+this.src);return}if(b[this.src][0]>=3){++w,O();return}var e=new Image;e.src=this.src,e.onload=k,e.onerror=L,b[this.src][1]&&(b[this.src][1]=e),++b[this.src][0]};this.autofit=function(){C(),$(window).resize(function(){u&&clearTimeout(u);var e=n.resizeAlwayInstantly()||autoResizerEnforceFastResize();!e&&a&&(a>Date.now()?e=!0:a=!1),e?(immidiateOnNextResize=u=!1,C()):u=setTimeout(function(){C()},1e3)}),$(window).on("orientationchange",function(e){u&&(clearTimeout(u),u=!1),C(),n.scrollToTopOnFlip()&&window.scrollTo(0,0)})},this.enforceImmidiateResizing=function(e){a=e},this.preload=function(e){l=typeof window.applicationCache!="undefined"&&window.applicationCache.status!=0,p=e.onLoaded,typeof e.onUpdate=="function"&&(d=e.onUpdate),typeof e.additionalCounter!="undefined"&&(E=e.additionalCounter);if(l)D(e.pictures);else{if(typeof e.lang=="string"||typeof e.resol!="undefined")for(var t=0,n=e.pictures.length;t<n;++t){var r=e.pictures[t];if(typeof e.lang=="string")if($.isArray(r)){var i=r[1].replace("<lang>",e.lang);i!=r[1]&&(r[1]=e.pictures[t][1]=i)}else{var i=r.replace("<lang>",e.lang);i!=r&&(r=e.pictures[t]=i)}if(typeof e.resol!="undefined")if($.isArray(r)){var i=r[1].replace("<resol>",e.resol);i!=r[1]&&(e.pictures[t][1]=i)}else{var i=r.replace("<resol>",e.resol);i!=r&&(e.pictures[t]=i)}}A(e.pictures)}},this.onExternProgress=function(e){S=e,O()},this.getCachedImg=function(e){return typeof T[e]=="undefined"?null:T[e]},this.isAppcacheActive=function(){return l},this.wasLoadingSuccessfull=function(){return w?!1:!0},this.freeCachedImg=function(e){$.isArray($name)||(e=[e]);for(var t=0;t<e.length;++t)typeof T[e[t]]!="undefined"&&delete T[e[t]]},this.getScalingFactor=function(){return o?o:1}};