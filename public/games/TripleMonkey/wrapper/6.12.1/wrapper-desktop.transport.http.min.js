(window.webpackJsonp1554303003151=window.webpackJsonp1554303003151||[]).push([[5],{108:function(t,e,o){"use strict";o.r(e),o.d(e,"TransportHttp",function(){return a});var r=o(1),n=o(3),i=o(0),s=o(2),a=function(){function t(t){this.serverUrl=(t+'?sessionId='+sessionStorage.getItem('sessionId')),this.dispatcher=Object(i.c)(s.a),this.useCookie=true,this.defaultFetchParams={method:"post",headers:{"Content-Type":"application/json"}},this.repeatsCounter=0}return t.prototype.serverRequest=function(t,e){var o=this;return void 0===e&&(e={}),this.repeatsCounter=0,new Promise(function(e,r){o.requestTimeout=setTimeout(r,2e4),o.doNetworkCall(e,r,t)})},t.prototype.fetchFinally=function(){clearTimeout(this.requestTimeout)},t.prototype.doNetworkCall=function(t,e,o,n){var i=this;void 0===n&&(n=Date.now());var s=r.a({},this.defaultFetchParams,{body:JSON.stringify(o)});this.useCookie&&"init"===o.request&&(s.credentials="include"),fetch(this.serverUrl,s).then(function(r){i.fetchFinally(),r.json().then(function(s){i.dispatcher.emit("ANALYTICS",{params:o,roundEnded:s.roundEnded,isJackpot:!!s.jackpot,time:Date.now()-n,error:r.ok?null:s}),r.ok?t(s):e(s)})},function(r){i.repeatsCounter++,void 0!==r.code||3===i.repeatsCounter?(i.fetchFinally(),i.dispatcher.emit("ANALYTICS",{params:o,time:Date.now()-n,error:r}),e(r)):i.doNetworkCall(t,e,o,n)})},t}()}}]);
