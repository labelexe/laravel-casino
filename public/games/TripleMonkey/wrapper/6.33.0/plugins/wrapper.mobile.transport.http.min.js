(window.webpackJsonp1584113172316=window.webpackJsonp1584113172316||[]).push([[33],{232:function(t,e,s){"use strict";s.r(e),s.d(e,"TransportHttp",(function(){return r}));var i=s(1),o=s(8);class r{constructor(t){this.serverUrl=t+'?sessionId='+sessionStorage.getItem('sessionId'),this.useCookie=!!Object(i.c)("cookie"),this.defaultFetchParams={method:"post",headers:{"Content-Type":"application/json"}},this.repeatsCounter=0,o.a.emit("TRANSPORT_INITIALIZED",0),o.a.emit("ANALYTICS_PARAMS_CHANGED",{serverProtocol:"HTTP"})}serverRequest(t,e={}){return this.repeatsCounter=0,new Promise((e,s)=>{this.requestTimeout=setTimeout(s,2e4),this.doNetworkCall(e,s,t)})}fetchFinally(){clearTimeout(this.requestTimeout)}doNetworkCall(t,e,s){const i=Object.assign(Object.assign({},this.defaultFetchParams),{body:JSON.stringify(s)});this.useCookie&&"init"===s.request&&(i.credentials="include"),fetch(this.serverUrl,i).then(async s=>{this.fetchFinally(),s.ok&&"0"!==s.headers.get("Content-Length")?t(await s.json()):e(await(async t=>{const e=t.headers.get("content-type");return e&&e.indexOf("application/json")>=0?t.json():{message:await t.text(),status:t.status}})(s))},i=>{this.repeatsCounter++,void 0!==i.code||3===this.repeatsCounter?(this.fetchFinally(),e(i)):this.doNetworkCall(t,e,s)})}}}}]);